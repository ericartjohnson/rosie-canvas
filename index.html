<!DOCTYPE html>
<html>
<head>
	<title>Eric Johnson</title>
	<style rel="stylsheet" type="text/css">
		body{padding:0; margin:0; width:100%; height:100%; overflow: hidden;}
		#framerate{position: absolute; top: 0;left: 0;}
	</style>
	<script type="text/javascript" src="canvas/scene.js"></script>
	<script type="text/javascript" src="canvas/views/view.js"></script>
	<script type="text/javascript" src="canvas/views/circle.js"></script>
	<script type="text/javascript" src="canvas/views/text.js"></script>
	<script type="text/javascript" src="canvas/views/rectangle.js"></script>
</head>
<body>
	<canvas id="canvas"></canvas>
	<script type="text/javascript">
		window.onready = function(){
			var canvas = document.getElementById('canvas');
			if (canvas.getContext){
				window.mainScene = new Canvas.Scene({
					'ctx':canvas.getContext('2d'),
					'showDebug' : true
				});
				window.mainScene.resize();

				window.centerCircle =  new Canvas.Views.Circle({
					'fillStyle' : 'rgba(100,150,100,1)',
					'shadowBlur' : 10,
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						self.translate = {'x':mainScene.center.x,'y':mainScene.center.y};
						var t = new Date().getTime();
						var s = Math.cos(t*2/1000)/2 + 1.1;
						self.scale = {'x':s,'y':s};
						for(var v in self.subviews){
							self.subviews[v].update(scene);
						}
					}
				});

				window.mainScene.addSubview(centerCircle);
				
				window.testText = new Canvas.Views.Text({
					'text' : 'hello world!',
					'font' : '50px sans-serif',
					'align' : 'center',
					'baseline' : 'middle',
					'shadowBlur' : 10,
					'shadowColor' : 'black',
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						var t = new Date().getTime();
						var x = Math.sin(t/1000) * 250 + scene.center.x;
						var y = -Math.cos(t/1000) * 130 + scene.center.y;
						self.translate = {'x':x,'y':y};
						self.rotate = Math.sin(t/1000)/2 * Math.PI;
					}
				});
				
				window.mainScene.addSubview(testText);

				window.testText2 = new Canvas.Views.Text({
					'text' : 'bye bye',
					'font' : '10px serif',
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						var t = new Date().getTime();
						self.rotate = -Math.tan(t/1000) * Math.PI;
					}
				});
				
				// window.mainScene.addSubview(testText2);
				window.centerCircle.addSubview(testText2);
				
				window.testRect = new Canvas.Views.Rectangle({
					'origin' : {'x':500, 'y':10},
					'strokeStyle' : 'rgb(100,100,200)',
					'fillStyle' : 'rgb(200,200,200)',
					'lineWidth' : 5,
					'stroke' : true,
					'cornerRadius' : 15,
					'update' : function(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						var t = new Date().getTime();
						self.cornerRadius = Math.abs(Math.sin(t/1000)/2) * 25;
					}
				});
				
				window.mainScene.addSubview(testRect);

				window.mainScene.render();
			}
		}

		window.onresize = function(){
			if(window.mainScene) mainScene.resize();
		}

		document.addEventListener('DOMContentLoaded',function(){
			document.removeEventListener('DOMContentLoaded',arguments.callee,false);
			window.onready();
		},false);
	</script>
	<p id="framerate"></p>
</body>
</html>