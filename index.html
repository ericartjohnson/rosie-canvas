<!DOCTYPE html>
<html>
<head>
	<title>Eric Johnson</title>
	<style rel="stylsheet" type="text/css">
		body{padding:0; margin:0; width:100%; height:100%; overflow: hidden;}
		#framerate{position: absolute; top: 0;left: 0;}
	</style>
	<!--<script type="text/javascript" src="jquery-1.8.2.min.js"></script>-->
	<script type="text/javascript" src="selfish.js"></script>
	<script type="text/javascript" src="canvas/scene.js"></script>
	<script type="text/javascript" src="canvas/views/view.js"></script>
	<script type="text/javascript" src="canvas/views/circle.js"></script>
	<script type="text/javascript" src="canvas/views/text.js"></script>
	<script type="text/javascript" src="canvas/views/rectangle.js"></script>
</head>
<body>
	<canvas id="canvas"></canvas>
	<script type="text/javascript">
		window.onready = function(){
			var canvas = document.getElementById('canvas');
			if (canvas.getContext){
				window.mainScene = Canvas.Scene.new({
					'ctx':canvas.getContext('2d'),
					'showDebug' : true,
					'animate' : true
				});
				window.mainScene.resize();

				window.centerCircle =  Canvas.Views.Circle.new({
					'translate' : {'x':mainScene.center.x,'y':mainScene.center.y},
					'scale' : {'x':1,'y':1},
					'fillStyle' : 'rgba(100,150,100,1)',
					'subviews' : [],
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						self.translate = {'x':mainScene.center.x,'y':mainScene.center.y};
						var t = new Date().getTime();
						var s = Math.cos(t*2/1000)/2 + 1.1;
						self.scale.x = s;
						self.scale.y = s;

						for(var v in self.subviews){
							self.subviews[v].update(scene);
						}
					}
				});

				window.mainScene.subviews.push(centerCircle);
				
				window.testText = Canvas.Views.Text.new({
					'text' : 'hello world!',
					'font' : '50px sans-serif',
					'align' : 'center',
					'baseline' : 'middle',
					'translate' : {'x':0, 'y':0},
					'scale' : {'x':1, 'y':1},
					'rotate' : Math.PI,
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						var t = new Date().getTime();
						self.translate.x = Math.sin(t/1000) * 250 + scene.center.x;
						self.translate.y = -Math.cos(t/1000) * 130 + scene.center.y;
						self.rotate = Math.sin(t/1000)/2 * Math.PI;
					}
				});
				
				window.mainScene.subviews.push(testText);

				window.testText2 = Canvas.Views.Text.new({
					'text' : 'bye bye',
					'font' : '10px serif',
					'origin' : {'x':0, 'y':0},
					'rotate' : Math.PI/4,
					'update' : function update(scene){
						if(!scene || !scene.ctx) return;
						var self = this;
						var t = new Date().getTime();
						self.rotate = -Math.tan(t/1000) * Math.PI;
					}
				});
				
				// window.mainScene.subviews.push(testText2);
				window.centerCircle.subviews.push(testText2);
				
				window.testRect = Canvas.Views.Rectangle.new({
					'origin' : {'x':500, 'y':10},
					'strokeStyle' : 'rgb(100,100,100)',
					'lineWidth' : 3,
					'stroke' : true
				});
				
				window.mainScene.subviews.push(testRect);

				window.mainScene.render();
			}
		}

		window.onresize = function(){
			if(window.mainScene) mainScene.resize();
		}

		document.addEventListener('DOMContentLoaded',function(){
			document.removeEventListener('DOMContentLoaded',arguments.callee,false);
			window.onready();
		},false);
	</script>
	<p id="framerate"></p>
</body>
</html>